<!DOCTYPE html>
<html>
<head>
    <title>VoxPro Debug</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #000; color: #0f0; }
        .test { margin: 20px 0; padding: 10px; border: 1px solid #0f0; }
        .success { background: #001100; }
        .error { background: #110000; color: #f00; }
        button { padding: 10px; margin: 5px; }
    </style>
</head>
<body>
    <h1>VoxPro API Debug</h1>
    
    <div class="test">
        <h2>Test 1: Direct Xano API</h2>
        <button onclick="testDirect()">Test Direct</button>
        <pre id="direct"></pre>
    </div>
    
    <div class="test">
        <h2>Test 2: Netlify Function</h2>
        <button onclick="testFunction()">Test Function</button>
        <pre id="function"></pre>
    </div>
    
    <div class="test">
        <h2>Test 3: Proxy Function</h2>
        <button onclick="testProxy()">Test Proxy</button>
        <pre id="proxy"></pre>
    </div>

    <script>
        async function testDirect() {
            const el = document.getElementById('direct');
            try {
                el.textContent = 'Testing...';
                const response = await fetch('https://xajo-bs7d-cagt.n7e.xano.io/api:pYeQctVX/user_submission');
                const data = await response.json();
                el.textContent = `SUCCESS! Status: ${response.status}\nData: ${JSON.stringify(data, null, 2)}`;
                el.className = 'success';
            } catch (err) {
                el.textContent = `FAILED!\n${err.message}\n${err.stack}`;
                el.className = 'error';
            }
        }
        
        async function testFunction() {
            const el = document.getElementById('function');
            try {
                el.textContent = 'Testing...';
                const response = await fetch('/.netlify/functions/list-media');
                const text = await response.text();
                let data;
                try {
                    data = JSON.parse(text);
                } catch {
                    data = text;
                }
                el.textContent = `Status: ${response.status}\nResponse: ${typeof data === 'string' ? data : JSON.stringify(data, null, 2)}`;
                el.className = response.ok ? 'success' : 'error';
            } catch (err) {
                el.textContent = `FAILED!\n${err.message}`;
                el.className = 'error';
            }
        }
        
        async function testProxy() {
            const el = document.getElementById('proxy');
            try {
                el.textContent = 'Testing...';
                const response = await fetch('/.netlify/functions/xano-proxy/user_submission');
                const text = await response.text();
                let data;
                try {
                    data = JSON.parse(text);
                } catch {
                    data = text;
                }
                el.textContent = `Status: ${response.status}\nResponse: ${typeof data === 'string' ? data : JSON.stringify(data, null, 2)}`;
                el.className = response.ok ? 'success' : 'error';
            } catch (err) {
                el.textContent = `FAILED!\n${err.message}`;
                el.className = 'error';
            }
        }
    </script>
</body>
</html>
